<!doctype html>













































<html
  class="not-ready lg:text-base"
  style="--bg: #faf8f1"
  lang="en"
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title> - cybercafe.dev</title>

  
  <meta name="theme-color" />

  
  
  
  
  <meta name="description" content="The behaviour Copy the code below and run it in a fresh browser window.
var obj = {a:22}; var p1 = new Promise((res, rej) =&gt; { res(55); }).then((val) =&gt; { obj.a = val; }); console.log(&#34;obj object&#34;, obj); console.log(&#34;obj.a&#34;, obj.a); The above snippet would output something like below
Since the assignment obj.a is within the then block, seeing value 22 in the logged output is perfectly fine. And of course once the promise is run, after that if you log the object you will see the updated value 55." />
  <meta name="author" content="amt8u" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="http://localhost:1313/main.min.css" />

  
  
  
  
  
  <link rel="preload" as="image" href="http://localhost:1313/theme.png" />

  
  
  
  
  <link rel="preload" as="image" href="https://www.gravatar.com/avatar/0166b1a7316fa3ce87a144e4f0cda911?s=160&amp;d=identicon" />
  
  

  
  
  <link rel="preload" as="image" href="http://localhost:1313/twitter.svg" />
  
  <link rel="preload" as="image" href="http://localhost:1313/github.svg" />
  
  <link rel="preload" as="image" href="http://localhost:1313/instagram.svg" />
  
  

  
  
  <script
    defer
    src="http://localhost:1313/highlight.min.js"
    onload="hljs.initHighlightingOnLoad();"
  ></script>
  

  
  
  

  
  <link rel="icon" href="http://localhost:1313/favicon.ico" />
  <link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png" />

  
  <meta name="generator" content="Hugo 0.125.7">

  
  
  
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header class="mx-auto flex h-[4.5rem] max-w-3xl px-8 lg:justify-center">
  <div class="relative z-50 mr-auto flex items-center">
    <a
      class="-translate-x-[1px] -translate-y-[1px] text-2xl font-semibold"
      href="http://localhost:1313/"
      >cybercafe.dev</a
    >
    <div
      class="btn-dark text-[0] ml-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 -mr-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
    role="button"
    aria-label="Menu"
  ></div>

  

  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#faf8f1'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"
  >
    
    
    <nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-6">
      
      <a
        class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal"
        href="/amt8u/"
        >About</a
      >
      
    </nav>
    

    
    <nav
      class="mt-12 flex justify-center space-x-10 dark:invert lg:ml-12 lg:mt-0 lg:items-center lg:space-x-6"
    >
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./twitter.svg)"
        href="https://twitter.com/amt8u"
        target="_blank"
        rel="me"
      >
        twitter
      </a>
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./github.svg)"
        href="https://github.com/amt8u"
        target="_blank"
        rel="me"
      >
        github
      </a>
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./instagram.svg)"
        href="https://instagram.com/amt8u"
        target="_blank"
        rel="me"
      >
        instagram
      </a>
      
    </nav>
    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-8 pb-16 pt-12 dark:prose-invert"
    >
      

<article>
  <header class="mb-16">
    <h1 class="!my-0 pb-2.5"></h1>

    
    <div class="text-sm antialiased opacity-60">
      
      
      
      
    </div>
    
  </header>

  <section><h1 id="the-behaviour">The behaviour</h1>
<p>Copy the code below and run it in a fresh browser window.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> {<span style="color:#a6e22e">a</span><span style="color:#f92672">:</span><span style="color:#ae81ff">22</span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">p1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">rej</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>(<span style="color:#ae81ff">55</span>);
</span></span><span style="display:flex;"><span>}).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">val</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">val</span>;
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;obj object&#34;</span>, <span style="color:#a6e22e">obj</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;obj.a&#34;</span>, <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">a</span>);
</span></span></code></pre></div><p>The above snippet would output something like below</p>
<p><img src="./images/wierd-console-log-behavior/console.log_output.png" alt="Default output"></p>
<p>Since the assignment <code>obj.a</code> is within the <code>then</code> block, seeing value <code>22</code> in the logged output is perfectly fine. And of course once the promise is run, after that if you log the object you will see the updated value <code>55</code>. But Now try expanding the same object using the arrow and see the magic.</p>
<p><img src="./images/wierd-console-log-behavior/console.log_output__expanded.png" alt="Exapanded output"></p>
<p>In case you didnlt notice:-D, I have marked it with red outline.</p>
<p>If you do the same exercise with a complex object like <code>window</code>, you will get similar result with a small difference.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">p1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">rej</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>(<span style="color:#ae81ff">55</span>);
</span></span><span style="display:flex;"><span>}).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">val</span>) =&gt; {
</span></span><span style="display:flex;"><span>    window.<span style="color:#a6e22e">aNewValue</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">val</span>;
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;window object&#34;</span>, window);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;window.aNewValue&#34;</span>, window.<span style="color:#a6e22e">aNewValue</span>);
</span></span></code></pre></div><br>
As expected, `window.aNewValue` prints `undefined`.
<p><img src="./images/wierd-console-log-behavior/window_aNewValue.png" alt="window"></p>
<p>Expand the object and see if the <code>window</code> object has <code>aNewValue</code> property. To your surprise the field would be there with the value <code>55</code>.</p>
<p><img src="./images/wierd-console-log-behavior/window_expanded_aNewValue.png" alt="window"></p>
<p>Now you would ask the question if the value is there in the object on line#7 then it should be there on line#8 too. Why did the second log statement print <code>undefined</code>?</p>
<h1 id="the-reason">The reason</h1>
<p>As per my understanding, the reason seems to be the implementation of <code>console.log</code>.</p>
<p>Whenever you log an object on the console, you see a small preview of the object</p>
<p><img src="./images/wierd-console-log-behavior/window_preview.png" alt="object preview"></p>
<br>
<p>But if you want to see all the properties, you expand the object.</p>
<p><img src="./images/wierd-console-log-behavior/window_expanded.png" alt="object expanded"></p>
<br>
<p>Notice that the order of the values in the preview is different than the order in the expanded object. I am not sure how this order is determined.</p>
<p>The preview seems to be constructed while logging the object syncronously while rest of the values are read only when you click on the expand icon. And thats why accessing the property value at that point of time gave <code>22</code> and not <code>55</code>. Do note that the expression <code>obj.a</code> results in a primitive value which is passed to the console.log function as a value and not reference.</p>
<p>Alternatively if you want the exact copy of your object in any point in time, you can use <code>JSON.stringify()</code> to serialize the object and then <code>JSON.parse()</code> to convert the string back to an object which you can expand and close but with the correct values.</p>
<p>With a simple object like <code>obj</code>, its easy to identify while with complex objects like <code>window</code>, you won&rsquo;t be able to see the issue since your random properties are not included in the preview.</p>
<p>Now, you must got the answer to the question - why the second log statement <code>console.log(obj.a)</code> printed <code>undefined</code>. At that time the value of <code>a</code> was undefined and the <code>console.log</code> function is called with a string as a parameter. If the property <code>a</code> itself would have been an object, it would also face the same issue. Objects are passed by reference while primitives are passed by values.</p>
<h1 id="some-other-helpful-links">Some other helpful links</h1>
<ul>
<li>
<p><a href="https://stackoverflow.com/questions/23429203/weird-behavior-with-objects-console-log">https://stackoverflow.com/questions/23429203/weird-behavior-with-objects-console-log</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/4057440/is-chromes-javascript-console-lazy-about-evaluating-arrays">https://stackoverflow.com/questions/4057440/is-chromes-javascript-console-lazy-about-evaluating-arrays</a></p>
</li>
</ul>
</section>

  
  

  
  
  
  
  <nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]">
    
    <a
      class="flex w-1/2 items-center rounded-l-md p-6 pr-3 font-semibold no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]"
      href="http://localhost:1313/posts/why-phishing-is-still-successfull/why-phishing-is-still-successfull/"
      ><span class="mr-1.5">←</span><span></span></a
    >
    
    
  </nav>
  
  

  
  

  
  

  


  
</article>


    </main>

    <footer
  class="opaco mx-auto flex h-[4.5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"
>
  <div class="mr-auto">
    &copy; 2024
    <a class="link" href="http://localhost:1313/">cybercafe.dev</a>
  </div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >Powered by Hugo️️</a
  >️
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >✎ Paper</a
  >
</footer>

  </body>
</html>
